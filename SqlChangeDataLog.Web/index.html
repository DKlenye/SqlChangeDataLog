<!DOCTYPE html>
<html>
<head>
    <title>ChangeLog</title>
    <link rel="stylesheet" type="text/css" href="Content/webix.css"/>
    <link rel="stylesheet" type="text/css" href="//cdn.webix.com/components/sidebar/sidebar.css">
    
    <script type="text/javascript" src="Scripts/polyfill.js"></script>
    <script type="text/javascript" src="Scripts/webix.js"></script>
    <script type="text/javascript" src="//cdn.webix.com/components/sidebar/sidebar.js"></script>
    
    <style type="text/css">
        
        .webix_layout_toolbar.webix_toolbar .bt_1 .webixtype_base{
            background: #3D7113;
        }
        
    </style>

    <script type="text/javascript">        


        webix.protoUI({
            name: 'database-toolbar',
            defaults: {
                id:'tbar',
                height:62,
                cols: [{ view: 'icon', icon: 'plus-circle',click:'$$("tbar")._addButton("DB2","transport")' }]
            },

           _addButton:function(server,database) {
                this.addView(this._createButton(server, database), 0);
            },

            _createButton: function (server, database) {
                var template = webix.template('<span class="webix_icon fa-icon fa-database"></span> #serverName# <br/>#databaseName#');
                return {
                    icon: 'database',
                    autowidth: true,
                    view: "button",
                    type: "htmlbutton",
                    icon: "database",
                    server: server,
                    database:database,
                    label: template({ serverName: server, databaseName: database }),
                    on: {
                        'onItemClick': this.onButtonClick
                    }
                };
            },
            
            onButtonClick:function(id) {
                var button = $$(id);
            }
            

        },webix.ui.toolbar);

        webix.ready(function () {


            var icons = {
                'insert': 'fa-plus-square-o',
                'update': 'fa-edit',
                'delete': 'fa-trash-o'
            };
            
            webix.ui({
                rows: [
                    {
                        view: "database-toolbar",
                        id: 'tbar'
                    },
                    {
                        cols: [
                        {
                            view: "sidebar",
                            collapsed:true,
                            data: [
                                {
                                    id: "tables",
                                    icon: "table",
                                    value: "Data log settings"
                                },
                                {
                                    id:"search",
                                    icon:"search",
                                    value:"View log data"
                                }
                            ]
                        },
                        {
                            view: 'datatable',
                            id:'tables',
                            gravity: 2,
                            select: "row",
                            on:{
                                    onBeforeLoad:function(){
                                        this.showOverlay("Loading...");  
                                    },
                                    onAfterLoad: function () {
                                        this.hideOverlay();
                                    }
                            },
                            columns: [
                                {
                                    id: 'Operations',
                                    header: [
                                        "Operations",
                                        {
                                            content: "selectFilter",
                                            options: [{ id: "All", value: "All" }, { id: "Logging", value: "Logging"}],
                                            compare: function(value, filter) {
                                                if (filter == "All") return true;
                                                return !!value;
                                            }
                                        }
                                    ],
                                    width: 100,
                                    template: function(obj) {

                                        if (!obj.Operations) return "";
                                        
                                        var buttonTpl = webix.template("<span class='webix_icon #icon#' style='cursor:pointer'></span>");
                                        var operations = obj.Operations;
                                        
                                        return operations.map(function(o) { return buttonTpl({ icon: icons[o] }); }).join("");

                                    }
                                },
                                { id: "Name", fillspace: true, header:["Table", {content:"textFilter"}] , sort: "string" }
                            ],
                            url:'Handlers/SelectTables.ashx'
                        },
                        { view: 'resizer' },
                            {
                                view: 'tabview',
                                cells: [
                                    {
                                        header: "<span class='webix_icon fa-trash-o'></span>Delete",
                                        view: 'datatable',
                                        columns: [
                                            { id: "insert", header: ["<span class='webix_icon "+icons['insert']+"'></span> Insert", { content: "masterCheckbox"}], template: "{common.checkbox()}", width: 100 },
                                            { id: "update", header: ["<span class='webix_icon " + icons['update'] + "'></span> Update", { content: "masterCheckbox"}], template: "{common.checkbox()}", width: 100 },
                                            { id: "delete", header: ["<span class='webix_icon " + icons['delete'] + "'></span> Delete", { content: "masterCheckbox"}], template: "{common.checkbox()}", width: 100 },
                                            { id: "ColumnName", fillspace: true, header: "Column Name" }
                                        ],
                                        data: [
		                                    { checked: true, ColumnName: 'VehicleId' },
                                            { checked: false, ColumnName: 'RegistrationNumber' }
	                                       ]
                                    },
                                    {
                                        header: "<span class='webix_icon fa-plus-square-o'></span>Insert",
                                        view:'datatable',
                                        columns: [
                                            { id: "checked", header: { content: "masterCheckbox" }, template: "{common.checkbox()}", width: 40 },
                                            { id: "ColumnName", fillspace: true, header: "Column Name" }
                                        ],
                                        data:[
		                                    { checked: true, ColumnName: 'VehicleId' },
                                            { checked: false, ColumnName: 'RegistrationNumber' }
	                                       ]
                                    },
                                    {
                                        header: "<span class='webix_icon fa-edit'></span>Update",
                                        view: 'datatable',
                                        columns: [
                                            { id: "checked", header: { content: "masterCheckbox" }, template: "{common.checkbox()}", width: 40 },
                                            { id: "ColumnName", fillspace: true, header: "Column Name" }
                                        ],
                                        data: [
		                                    { checked: true, ColumnName: 'VehicleId' },
                                            { checked: false, ColumnName: 'RegistrationNumber' }
	                                       ]
                                    }
                                ]
                            }
                        ]
                    }

                ]

            });

        });

    </script>

</head>
<body>

</body>
</html>
